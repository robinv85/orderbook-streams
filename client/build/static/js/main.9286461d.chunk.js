(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{16:function(e,a,t){e.exports=t(35)},21:function(e,a,t){},34:function(e,a,t){},35:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(5),s=t.n(c),o=(t(21),t(6)),l=t.n(o),i=t(13),m=t(15),u=t(14),d=t(2),p=t(1),b=t(3),k=t(7),v=t.n(k);function f(e){return new Promise((function(a){var t=new FileReader;t.onload=function(){a(JSON.parse(t.result))},t.readAsText(e)}))}function E(e){var a=e.asks,t=void 0===a?[]:a,n=e.bids,c=void 0===n?[]:n,s=e.exchangeName,o=e.pair,l=e.midPrice,i=e.spread,m=e.onRemove;return r.a.createElement("li",{className:"Market"},r.a.createElement("header",{className:"Market-header"},r.a.createElement("h3",null,s," ",o),r.a.createElement("p",null,"Speed: 53 ob/min")),r.a.createElement("ul",{className:"AsksList"},t.map((function(e){return r.a.createElement("li",{key:e[0]+e[1],className:"Ask"},r.a.createElement("span",{className:"AskPrice"},e[0]),r.a.createElement("span",{className:""},e[1]))}))),r.a.createElement("div",{className:"Market-highlight"},r.a.createElement("div",{className:"MidPrice"},l&&"".concat(l," USD")),r.a.createElement("div",{className:"Spread"},i&&"".concat(i," %"))),r.a.createElement("ul",{className:"BidsList"},c.map((function(e){return r.a.createElement("li",{key:e[0]+e[1],className:"Bid"},r.a.createElement("span",{className:"BidPrice"},e[0]),r.a.createElement("span",{className:""},e[1]))}))),r.a.createElement("p",{className:"RemoveMarket",onClick:m},r.a.createElement("span",{className:"RemoveMarketButton"}," \u2716 "),r.a.createElement("span",{className:"RemoveMarketText"},"Click to remove market")))}function h(e){var a=e.browseAvailableMarkets,t=e.markets,n=e.online,c=e.removeMarket;return r.a.createElement("ul",{className:"MarketsList"},t.map((function(e){return r.a.createElement(E,Object.assign({key:e.id,onRemove:function(){return c(e.id)}},e))})),n?r.a.createElement("li",{className:"NewMarketPlaceholder",onClick:a},r.a.createElement("span",{className:"AddMarketButton"}," + "),r.a.createElement("p",null,"Click to add a new market")):r.a.createElement("li",{className:"ConnectingPlaceholder"},"Connecting to server..."))}t(34);var N="INITIALIZING",g="CONNECTED",O="RECONNECTING",j=new WebSocket("ws://localhost:9000");v.a.setAppElement("#root");var w=function(){var e=Object(n.useState)(N),a=Object(b.a)(e,2),t=a[0],c=a[1],s=r.a.useState(!1),o=Object(b.a)(s,2),k=o[0],E=o[1],w=Object(n.useState)([]),x=Object(b.a)(w,2),M=x[0],S=x[1],A=Object(n.useState)({}),C=Object(b.a)(A,2),I=C[0],y=C[1],P=function(){return E(!1)},B=M.reduce((function(e,a){var t=a.id,n=a.name,r=a.pairs;return Object(p.a)({},e,{},r.filter((function(e){return!I.hasOwnProperty("".concat(t,".").concat(e))})).map((function(e){return{id:"".concat(t,".").concat(e),exchangeId:t,exchangeName:n,pair:e}})).reduce((function(e,a){return Object(p.a)({},e,Object(d.a)({},a.id,a))}),{}))}),{});return Object(n.useEffect)((function(){j.onopen=function(){c(g)},j.onmessage=function(){var e=Object(i.a)(l.a.mark((function e(a){var t,n,r,c,s,o,i,m,u,b,k,v,E,h,N,g,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(a.data instanceof Blob)){e.next=7;break}return e.next=4,f(a.data);case 4:c=e.sent,e.next=8;break;case 7:c=JSON.parse(a.data);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("failed parsing message: ",a.data);case 13:if(console.log("message:",JSON.stringify(c)),(null===(t=c)||void 0===t?void 0:t.exchanges)&&S(c.exchanges),!(null===(n=c)||void 0===n?void 0:n.exchange)||!(null===(r=c)||void 0===r?void 0:r.pair)){e.next=24;break}if(o=(s=c).exchange,i=s.pair,m=s.snapshot,u="".concat(o,".").concat(i),I.hasOwnProperty(u)){e.next=21;break}return console.error("Got message for unknown subscription: exchangeId=".concat(o," pair=").concat(i)),e.abrupt("return");case 21:b=I[u],m&&(v=m.asks,E=m.bids,k=Object(p.a)({},b,{asks:v.reverse(),bids:E})),k&&(h=k.asks[2][0],N=k.bids[0][0],O=(h-N)/(g=(h+N)/2),console.log({updateSubscription:k,subscriptionId:u,midPrice:g,spread:O}),y(Object(p.a)({},I,Object(d.a)({},u,Object(p.a)({},k,{midPrice:g,spread:O})))));case 24:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(a){return e.apply(this,arguments)}}(),j.onclose=function(){c(O),console.error("ws closed")},j.onerror=function(){return console.error("ws error")}}),[I]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"StatusBar"},"Status:",r.a.createElement("span",{className:"status ".concat(t===O?"status-error":"status-ok")},t)),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Orderbooks")),t===N?r.a.createElement("p",null,"Connecting to server..."):r.a.createElement(h,{exchanges:M,online:t===g,markets:Object.values(I),browseAvailableMarkets:function(){return E(!0)},removeMarket:function(e){var a=I[e],t=Object(m.a)(I,[e].map(u.a)),n=a.exchangeId,r=a.pair;j.send(JSON.stringify({action:"unsubscribe",exchangeId:n,pair:r})),y(t)}}),r.a.createElement(v.a,{className:"AddMarketModal",isOpen:k,onRequestClose:P,contentLabel:"Add market"},r.a.createElement("h2",null,"Add market"),r.a.createElement("p",null,"Select which market you want to track (available:"," ",Object.keys(B).length,")"),r.a.createElement("ul",{className:"AddMarketsList"},Object.entries(B).map((function(e){var a=Object(b.a)(e,2),t=a[0],n=a[1],c=n.exchangeName,s=n.pair;return r.a.createElement("li",{className:"AddMarketsListItem",key:t,onClick:function(){return function(e,a){var t=a.exchangeId,n=a.pair,r=Object(p.a)({},a,{asks:[],bids:[],midPrice:null,spread:null});y(Object(p.a)({},I,Object(d.a)({},e,r))),P(),j.send(JSON.stringify({action:"subscribe",exchangeId:t,pair:n}))}(t,n)}},"+ ",c,": ",s)}))),r.a.createElement("div",null,r.a.createElement("button",{className:"button-cancel",onClick:P},"Cancel"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.9286461d.chunk.js.map