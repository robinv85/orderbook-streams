(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{14:function(e,a,t){e.exports=t(33)},19:function(e,a,t){},32:function(e,a,t){},33:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(5),s=t.n(r),l=(t(19),t(6)),o=t.n(l),i=t(13),m=t(2),u=t(3),d=t(1),p=t(7),E=t.n(p);function N(e){return new Promise((function(a){var t=new FileReader;t.onload=function(){console.log("reader res:",t.result),a(JSON.parse(t.result))},t.readAsText(e)}))}function k(){return c.a.createElement("div",{className:"Market"},c.a.createElement("header",{className:"Market-header"},c.a.createElement("h3",null,"Kraken BTC/USD"),c.a.createElement("p",null,"Speed: 53 ob/min")),c.a.createElement("ul",{className:"AsksList"},c.a.createElement("li",{className:"Ask"},c.a.createElement("span",{className:"AskPrice"},"7107.3"),c.a.createElement("span",{className:""},"25.0")),c.a.createElement("li",{className:"Ask"},c.a.createElement("span",{className:"AskPrice"},"7107.3"),c.a.createElement("span",{className:""},"25.0")),c.a.createElement("li",{className:"Ask"},c.a.createElement("span",{className:"AskPrice"},"7107.3"),c.a.createElement("span",{className:""},"25.0"))),c.a.createElement("div",{className:"Market-highlight"},c.a.createElement("div",{className:"MidPrice"},"7142.5 USD"),c.a.createElement("div",{className:"Spread"},"0.03%")),c.a.createElement("ul",{className:"BidsList"},c.a.createElement("li",{className:"Bid"},c.a.createElement("span",{className:"BidPrice"},"7104.8"),c.a.createElement("span",{className:""},"22.1")),c.a.createElement("li",{className:"Bid"},c.a.createElement("span",{className:"BidPrice"},"7104.8"),c.a.createElement("span",{className:""},"22.1")),c.a.createElement("li",{className:"Bid"},c.a.createElement("span",{className:"BidPrice"},"7104.8"),c.a.createElement("span",{className:""},"22.1"))))}function b(e){var a=e.browseAvailableMarkets,t=e.markets,n=e.online;return console.log("subscriptions:",{markets:t}),c.a.createElement("ul",{className:"MarketsList"},t.map((function(e){return c.a.createElement(k,Object.assign({key:"".concat(e.exchange,".").concat(e.pair)},e))})),n?c.a.createElement("li",{className:"NewMarketPlaceholder",onClick:a},c.a.createElement("span",{className:"AddMarketButton"}," + "),c.a.createElement("p",null,"Click to add a new market")):c.a.createElement("p",null,"Connecting to server..."))}t(32);var h="INITIALIZING",f="CONNECTED",v="RECONNECTING",g=new WebSocket("ws://localhost:9000");E.a.setAppElement("#root");var O=function(){var e=Object(n.useState)(h),a=Object(d.a)(e,2),t=a[0],r=a[1],s=c.a.useState(!1),l=Object(d.a)(s,2),p=l[0],k=l[1],O=Object(n.useState)([]),w=Object(d.a)(O,2),A=w[0],j=w[1],x=Object(n.useState)({}),M=Object(d.a)(x,2),S=M[0],B=M[1],C=function(){return k(!1)},I=A.reduce((function(e,a){var t=a.id,n=a.name,c=a.pairs;return Object(u.a)({},e,{},c.filter((function(e){return!S.hasOwnProperty("".concat(t,".").concat(e))})).map((function(e){return{id:"{exchangeId}.".concat(e),exchangeId:t,exchangeName:n,pair:e}})).reduce((function(e,a){return Object(u.a)({},e,Object(m.a)({},a.id,a))}),{}))}),{});return console.log({availableMarkets:I}),Object(n.useEffect)((function(){g.onopen=function(){r(f)},g.onmessage=function(){var e=Object(i.a)(o.a.mark((function e(a){var t,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(a.data instanceof Blob)){e.next=7;break}return e.next=4,N(a.data);case 4:c=e.sent,e.next=8;break;case 7:c=JSON.parse(a.data);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("failed parsing message: ",a.data);case 13:console.log("message:",c),(null===(t=c)||void 0===t?void 0:t.exchanges)&&j(c.exchanges),null===(n=c)||void 0===n||n.pair;case 16:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(a){return e.apply(this,arguments)}}(),g.onclose=function(){r(v),console.log("ws closed")},g.onerror=function(){return console.log("ws error")}}),[g]),c.a.createElement("div",{className:"App"},c.a.createElement("div",{className:"StatusBar"},"Status:",c.a.createElement("span",{className:"status ".concat(t===v?"status-error":"status-ok")},t)),c.a.createElement("header",{className:"App-header"},c.a.createElement("h1",null,"Orderbooks")),t===h?c.a.createElement("p",null,"Connecting to server..."):c.a.createElement(b,{exchanges:A,online:t===f,markets:Object.values(S),browseAvailableMarkets:function(){return k(!0)}}),c.a.createElement(E.a,{className:"AddMarketModal",isOpen:p,onRequestClose:C,contentLabel:"Add market"},c.a.createElement("h2",null,"Add market"),c.a.createElement("p",null,"Select which market you want to track (available:"," ",Object.keys(I).length,")"),c.a.createElement("ul",{className:"AddMarketsList"},Object.entries(I).map((function(e){var a=Object(d.a)(e,2),t=a[0],n=a[1],r=n.exchangeName,s=n.pair;return c.a.createElement("li",{className:"AddMarketsListItem",key:t,onClick:function(){return function(e,a){var t=a.exchangeId,n=a.pair;console.log("onAddMarket",{exchangeId:t,pair:n});var c=Object(u.a)({},a,{asks:[],bids:[],midPrice:null,spread:null});B(Object(u.a)({},S,Object(m.a)({},e,c))),C(),g.send(JSON.stringify({action:"subscribe",exchangeId:t,pair:n}))}(t,n)}},"+ ",r,": ",s)}))),c.a.createElement("div",null,c.a.createElement("button",{className:"button-cancel",onClick:C},"Cancel"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.5ca1be38.chunk.js.map