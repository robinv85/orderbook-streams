(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{16:function(e,a,t){e.exports=t(35)},21:function(e,a,t){},34:function(e,a,t){},35:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(5),s=t.n(c),o=(t(21),t(6)),l=t.n(o),i=t(13),u=t(15),m=t(14),d=t(2),p=t(1),k=t(3),v=t(7),b=t.n(v);function f(e){return new Promise((function(a){var t=new FileReader;t.onload=function(){a(JSON.parse(t.result))},t.readAsText(e)}))}function h(e){var a=e.asks,t=void 0===a?[]:a,n=e.bids,c=void 0===n?[]:n,s=e.exchangeName,o=e.pair,l=e.speed,i=e.onRemove,u=function(e,a){if(!e.length||!a.length)return{};var t=e[0][0],n=a[0][0],r=((t+n)/2).toFixed(7);return{midPrice:r,spread:((t-n)/r).toFixed(7)}}(t,c),m=u.midPrice,d=void 0===m?"":m,p=u.spread,k=void 0===p?"":p;return r.a.createElement("li",{className:"Market"},r.a.createElement("header",{className:"Market-header"},r.a.createElement("h3",null,s," ",o),r.a.createElement("p",null,"Speed: ",l&&"".concat(l," updates/minute"))),r.a.createElement("ul",{className:"AsksList"},t.reverse().map((function(e,a){return r.a.createElement("li",{key:"".concat(a).concat(e[0]),className:"Ask"},r.a.createElement("span",{className:"AskPrice"},e[0]),r.a.createElement("span",{className:""},e[1]))}))),r.a.createElement("div",{className:"Market-highlight"},r.a.createElement("div",{className:"MidPrice"},d&&"".concat(d," USD")),r.a.createElement("div",{className:"Spread"},k&&"".concat(k," %"))),r.a.createElement("ul",{className:"BidsList"},c.map((function(e,a){return r.a.createElement("li",{key:"".concat(a).concat(e[0]),className:"Bid"},r.a.createElement("span",{className:"BidPrice"},e[0]),r.a.createElement("span",{className:""},e[1]))}))),r.a.createElement("p",{className:"RemoveMarket",onClick:i},r.a.createElement("span",{className:"RemoveMarketButton"}," \u2716 "),r.a.createElement("span",{className:"RemoveMarketText"},"Click to remove market")))}function E(e){var a=e.browseAvailableMarkets,t=e.markets,n=e.online,c=e.removeMarket;return r.a.createElement("ul",{className:"MarketsList"},t.map((function(e){return r.a.createElement(h,Object.assign({key:e.id,onRemove:function(){return c(e.id)}},e))})),n?r.a.createElement("li",{className:"NewMarketPlaceholder",onClick:a},r.a.createElement("span",{className:"AddMarketButton"}," + "),r.a.createElement("p",null,"Click to add a new market")):r.a.createElement("li",{className:"ConnectingPlaceholder"},"Connecting to server..."))}t(34);var N="INITIALIZING",g="CONNECTED",O="RECONNECTING",x=new WebSocket("ws://localhost:9000");b.a.setAppElement("#root");var w=function(){var e=Object(n.useState)(N),a=Object(k.a)(e,2),t=a[0],c=a[1],s=r.a.useState(!1),o=Object(k.a)(s,2),v=o[0],h=o[1],w=Object(n.useState)([]),j=Object(k.a)(w,2),M=j[0],A=j[1],S=Object(n.useState)({}),C=Object(k.a)(S,2),I=C[0],y=C[1],P=function(){return h(!1)},B=M.reduce((function(e,a){var t=a.id,n=a.name,r=a.pairs;return Object(p.a)({},e,{},r.filter((function(e){return!I.hasOwnProperty("".concat(t,".").concat(e))})).map((function(e){return{id:"".concat(t,".").concat(e),exchangeId:t,exchangeName:n,pair:e}})).reduce((function(e,a){return Object(p.a)({},e,Object(d.a)({},a.id,a))}),{}))}),{});return Object(n.useEffect)((function(){x.onopen=function(){c(g)},x.onmessage=function(){var e=Object(i.a)(l.a.mark((function e(a){var t,n,r,c,s,o,i,u,m,k,v,b,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(a.data instanceof Blob)){e.next=7;break}return e.next=4,f(a.data);case 4:c=e.sent,e.next=8;break;case 7:c=JSON.parse(a.data);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("failed parsing message: ",a.data);case 13:if((null===(t=c)||void 0===t?void 0:t.exchanges)&&A(c.exchanges),!(null===(n=c)||void 0===n?void 0:n.exchange)||!(null===(r=c)||void 0===r?void 0:r.pair)){e.next=22;break}if(o=(s=c).exchange,i=s.pair,u=s.asks,m=s.bids,k=s.speed,v="".concat(o,".").concat(i),I.hasOwnProperty(v)){e.next=20;break}return console.error("Got message for unknown subscription: exchangeId=".concat(o," pair=").concat(i)),e.abrupt("return");case 20:b=I[v],(u||m||k)&&(h=Object(p.a)({},b,{},u&&{asks:u},{},m&&{bids:m},{},void 0!==k&&{speed:k}),y(Object(p.a)({},I,Object(d.a)({},v,h))));case 22:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(a){return e.apply(this,arguments)}}(),x.onclose=function(){c(O),console.error("ws closed")},x.onerror=function(){return console.error("ws error")}}),[I]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"StatusBar"},"Status:",r.a.createElement("span",{className:"status ".concat(t===O?"status-error":"status-ok")},t)),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Orderbooks")),t===N?r.a.createElement("p",null,"Connecting to server..."):r.a.createElement(E,{exchanges:M,online:t===g,markets:Object.values(I),browseAvailableMarkets:function(){return h(!0)},removeMarket:function(e){var a=I[e],t=Object(u.a)(I,[e].map(m.a)),n=a.exchangeId,r=a.pair;x.send(JSON.stringify({action:"unsubscribe",exchangeId:n,pair:r})),y(t)}}),r.a.createElement(b.a,{className:"AddMarketModal",isOpen:v,onRequestClose:P,contentLabel:"Add market"},r.a.createElement("h2",null,"Add market"),r.a.createElement("p",null,"Select which market you want to track (available:"," ",Object.keys(B).length,")"),r.a.createElement("ul",{className:"AddMarketsList"},Object.entries(B).map((function(e){var a=Object(k.a)(e,2),t=a[0],n=a[1],c=n.exchangeName,s=n.pair;return r.a.createElement("li",{className:"AddMarketsListItem",key:t,onClick:function(){return function(e,a){var t=a.exchangeId,n=a.pair,r=Object(p.a)({},a,{asks:[],bids:[],speed:null});y(Object(p.a)({},I,Object(d.a)({},e,r))),P(),x.send(JSON.stringify({action:"subscribe",exchangeId:t,pair:n}))}(t,n)}},"+ ",c,": ",s)}))),r.a.createElement("div",null,r.a.createElement("button",{className:"button-cancel",onClick:P},"Cancel"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.436c1e26.chunk.js.map